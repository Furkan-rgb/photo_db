(this.webpackJsonpphoto_db=this.webpackJsonpphoto_db||[]).push([[0],{95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(0),r=n.n(c),i=n(14),s=n.n(i),o=n(10),l=n(50),u=(n(97),n(98),n(88),l.a.initializeApp({apiKey:"AIzaSyDWXRfh9yAdeUc94EGY35pIw3gWc0gl0Wg",authDomain:"photodb-f65f0.firebaseapp.com",projectId:"photodb-f65f0",storageBucket:"photodb-f65f0.appspot.com",messagingSenderId:"1093378767797",appId:"1:1093378767797:web:e29681d7866b005b1df7fc"})),d=l.a.storage(),j=l.a.firestore(),b=l.a.firestore.FieldValue.serverTimestamp,p=u.auth(),m=r.a.createContext();function h(){return Object(c.useContext)(m)}function O(e){var t=e.children,n=Object(c.useState)(),r=Object(o.a)(n,2),i=r[0],s=r[1],l=Object(c.useState)(!0),u=Object(o.a)(l,2),d=u[0],j=u[1];Object(c.useEffect)((function(){return p.onAuthStateChanged((function(e){s(e),j(!1)}))}),[]);var b={currentUser:i,signup:function(e,t){return p.createUserWithEmailAndPassword(e,t)},login:function(e,t){return p.signInWithEmailAndPassword(e,t)},logout:function(){return p.signOut()},resetPassword:function(e){return p.sendPasswordResetEmail(e)},updateEmail:function(e){return p.currentUser.updateEmail(e)},updatePassword:function(e){return p.currentUser.updatePassword(e)},deleteAccount:function(){return p.currentUser.delete()},updateDisplayName:function(e){return p.currentUser.updateProfile({displayName:e})}};return Object(a.jsx)(m.Provider,{value:b,children:!d&&t})}var f=n(18),x=n.n(f),g=n(28),v=n(133),y=n(135),w=n(73),N=n(146),S=n(137),P=n(147),R=n(130),k=n(15),F=n(22),C=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},width:"80%"},container:{height:"100vh"},card:{width:"100%",marginBottom:10,paddingBottom:5},inputField:{width:"100%",maxWidth:350}}}));function I(){var e=C(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),i=Object(c.useRef)(),s=h().signup,l=Object(c.useState)(""),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),p=Object(o.a)(b,2),m=p[0],O=p[1],f=Object(k.g)();function R(){return(R=Object(g.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n.current.value===r.current.value){e.next=3;break}return e.abrupt("return",j("Passwords do not match"));case 3:return e.prev=3,j(""),O(!0),e.next=8,s(t.current.value,n.current.value).then((function(e){return e.user.updateProfile({displayName:i.current.value})}));case 8:f.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),j(e.t0.message);case 14:O(!1);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}return Object(a.jsx)(v.a,{container:!0,className:e.container,justify:"center",alignItems:"center",children:Object(a.jsxs)(v.a,{item:!0,xs:12,sm:6,children:[Object(a.jsx)(y.a,{className:e.card,children:Object(a.jsxs)(v.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(a.jsx)(w.a,{align:"center",variant:"h3",component:"h2",children:"Sign up"}),d&&Object(a.jsx)(P.a,{severity:"error",children:d}),Object(a.jsxs)("form",{onSubmit:function(e){return R.apply(this,arguments)},align:"center",className:e.root,children:[Object(a.jsxs)(v.a,{item:!0,children:[Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"display-name",label:"Display Name",inputRef:i,textalign:"center"}),Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"email-input",label:"Email",inputRef:t,textalign:"center"})]}),Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"password-input",label:"Password",type:"password",autoComplete:"current-password",inputRef:n})}),Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"password-confirm",label:"Password-confirm",type:"password",autoComplete:"current-password",inputRef:r})}),Object(a.jsx)(S.a,{disabled:m,variant:"contained",color:"primary",type:"submit",children:"Sign Up"})]})]})}),Object(a.jsxs)(w.a,{align:"center",variant:"subtitle1",component:"h2",children:["Already have an account? ",Object(a.jsx)(F.b,{to:"/login",children:"Log in"})]})]})})}var U=n(136),E=n(138),D=n(139),B=n(140),A=n(141),L=function(e){var t=Object(c.useState)(0),n=Object(o.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)(null),s=Object(o.a)(i,2),l=s[0],u=s[1],p=Object(c.useState)(null),m=Object(o.a)(p,2),O=m[0],f=m[1],v=h().currentUser;return Object(c.useEffect)((function(){var t=d.ref(e.name),n=j.collection("images");t.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;r(t)}),(function(e){u(e)}),Object(g.a)(x.a.mark((function e(){var a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:a=e.sent,c=b(),n.add({url:a,createdAt:c,userID:v.uid}),f(a);case 6:case"end":return e.stop()}}),e)}))))}),[e,v]),{progress:a,url:O,error:l}},W=function(e){var t=e.file,n=e.setFile,r=L(t),i=r.url,s=r.progress;return console.log(s,i),Object(c.useEffect)((function(){i&&n(null)}),[i,n]),Object(a.jsx)("div",{className:"progress-bar",style:{width:s+"%"}})},q=n(30),T=function(e){var t=Object(c.useState)([]),n=Object(o.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){var t=j.collection(e).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(q.a)(Object(q.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return t()}}),[e]),{docs:a}},z=function(e){var t=Object(c.useState)([]),n=Object(o.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){var t=j.collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(q.a)(Object(q.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return t()}}),[e]),{docs2:a}},V=function(){var e=T("images").docs,t=z("accounts").docs2;return console.log(t),Object(a.jsx)(v.a,{container:!0,justify:"center",children:e&&e.map((function(e){return Object(a.jsxs)(v.a,{className:"img-item",item:!0,xs:12,md:6,lg:4,children:[Object(a.jsx)("img",{src:e.url,alt:"uploaded pic"}),Object(a.jsxs)(w.a,{variant:"subtitle1",children:[" By ",e.userID," "]})]},e.id)}))})},_=n(149),J=n(142),G=n(143),H=n(144),K=n(145),M=Object(R.a)((function(e){return{internalCardContainer:{"& > *":{margin:e.spacing(0)},padding:5},mainContainer:{width:"100%"},input:{display:"none"},info:{width:"100%"},card:{width:"100%",maxWidth:600,marginTop:5,marginBottom:5},button:{paddingTop:5,paddingBottom:10},icon:{fontSize:"2em"}}}));function X(){var e=M(),t=Object(c.useState)(""),n=Object(o.a)(t,2),i=n[0],s=n[1],l=Object(k.g)(),u=h(),d=u.currentUser,j=u.logout,b=u.deleteAccount,p=r.a.useState(!1),m=Object(o.a)(p,2),O=m[0],f=m[1],N=function(){f(!1)};function R(){return(R=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),e.prev=1,e.next=4,j();case 4:l.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),s("Failed to logout");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function C(){return(C=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),e.prev=1,e.next=4,b();case 4:l.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),s(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var I=Object(c.useState)(null),L=Object(o.a)(I,2),q=L[0],T=L[1],z=["image/png","image/jpeg"];return Object(a.jsxs)(v.a,{container:!0,justify:"center",children:[Object(a.jsx)(v.a,{item:!0,xs:12,sm:8,align:"center",children:Object(a.jsx)(y.a,{className:e.card,align:"center",children:Object(a.jsxs)(v.a,{container:!0,direction:"column",className:e.internalCardContainer,children:[Object(a.jsxs)(v.a,{item:!0,align:"center",children:[Object(a.jsx)(w.a,{align:"center",gutterBottom:!0,variant:"h2",children:"Storygram"}),Object(a.jsxs)(w.a,{children:["Email: ",d.email," "]}),Object(a.jsxs)(w.a,{children:["Username: ",d.displayName," "]}),Object(a.jsxs)(w.a,{children:["UserID: ",d.uid," "]})]}),Object(a.jsxs)(v.a,{item:!0,className:e.info,children:[i&&Object(a.jsx)(P.a,{severity:"error",children:i}),q&&Object(a.jsxs)(P.a,{severity:"info",children:["Selected image: ",q.name]})]}),q&&Object(a.jsx)(W,{align:"left",file:q,setFile:T}),Object(a.jsxs)(v.a,{container:!0,direction:"row",children:[Object(a.jsxs)(v.a,{item:!0,align:"center",className:e.button,xs:6,sm:3,children:[Object(a.jsx)("input",{accept:"image/*",className:e.input,id:"icon-button-file",type:"file",onChange:function(e){var t=e.target.files[0];t&&z.includes(t.type)?(T(t),s("")):(T(null),s("Please select an image file (png or jpeg)"))}}),Object(a.jsx)("label",{htmlFor:"icon-button-file",children:Object(a.jsx)(U.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(a.jsx)(E.a,{className:e.icon})})}),Object(a.jsx)(w.a,{children:"Upload an image"})]}),Object(a.jsxs)(v.a,{item:!0,align:"center",className:e.button,xs:6,sm:3,children:[Object(a.jsx)(U.a,{color:"primary","aria-label":"account",component:F.b,to:"./UpdateProfile",children:Object(a.jsx)(D.a,{className:e.icon})}),Object(a.jsx)(w.a,{children:"Update account"})]}),Object(a.jsxs)(v.a,{item:!0,align:"center",className:e.button,xs:6,sm:3,children:[Object(a.jsx)(U.a,{color:"primary","aria-label":"log out",onClick:function(){return R.apply(this,arguments)},component:"span",children:Object(a.jsx)(B.a,{className:e.icon})}),Object(a.jsx)(w.a,{children:"Log out"})]}),Object(a.jsxs)(v.a,{item:!0,align:"center",className:e.button,xs:6,sm:3,children:[Object(a.jsx)(U.a,{color:"secondary","aria-label":"log out",onClick:function(){f(!0)},component:"span",children:Object(a.jsx)(A.a,{className:e.icon})}),Object(a.jsx)(w.a,{children:"Delete Account"}),Object(a.jsxs)(_.a,{open:O,onClose:N,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(a.jsx)(J.a,{id:"alert-dialog-title",children:"Are you sure you want to delete your account?"}),Object(a.jsx)(G.a,{children:Object(a.jsx)(H.a,{id:"alert-dialog-description",children:"Deleting your account can not be undone."})}),Object(a.jsxs)(K.a,{children:[Object(a.jsx)(S.a,{onClick:N,color:"primary",children:"Cancel"}),Object(a.jsx)(S.a,{onClick:function(){return C.apply(this,arguments)},color:"primary",autoFocus:!0,children:"Delete"})]})]})]})]})]})})}),Object(a.jsx)(v.a,{item:!0,align:"center",children:Object(a.jsx)(V,{})})]})}var Y=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},width:"80%"},container:{height:"100vh"},card:{width:"100%",marginBottom:10,paddingBottom:5},inputField:{width:"100%",maxWidth:350}}}));function Q(){var e=Y(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=h().login,i=Object(c.useState)(""),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(c.useState)(!1),j=Object(o.a)(d,2),b=j[0],p=j[1],m=Object(k.g)();function O(){return(O=Object(g.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,u(""),p(!0),e.next=6,r(t.current.value,n.current.value);case 6:m.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),u("Failed to log in");case 12:p(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}return Object(a.jsx)(v.a,{container:!0,className:e.container,justify:"center",alignItems:"center",children:Object(a.jsxs)(v.a,{item:!0,xs:12,sm:6,children:[Object(a.jsx)(y.a,{className:e.card,children:Object(a.jsxs)(v.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(a.jsx)(w.a,{align:"center",variant:"h3",component:"h2",children:"Login"}),l&&Object(a.jsx)(P.a,{severity:"error",children:l}),Object(a.jsxs)("form",{onSubmit:function(e){return O.apply(this,arguments)},align:"center",className:e.root,children:[Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"email-input",label:"Email",inputRef:t,textalign:"center"})}),Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"password-input",label:"Password",type:"password",autoComplete:"current-password",inputRef:n})}),Object(a.jsx)(S.a,{disabled:b,variant:"contained",color:"primary",type:"submit",children:"Login"}),Object(a.jsx)(w.a,{children:Object(a.jsx)(F.b,{to:"/forgot-password",children:"Forgot password?"})})]})]})}),Object(a.jsxs)(w.a,{align:"center",variant:"subtitle1",component:"h2",children:["Need an account? ",Object(a.jsx)(F.b,{to:"/signup",children:"Sign up"})]})]})})}var Z=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},width:"80%"},container:{height:"100vh"},card:{width:"100%",marginBottom:10,paddingBottom:5},inputField:{width:"100%",maxWidth:350}}}));function $(){var e=Z(),t=Object(c.useRef)(),n=h().resetPassword,r=Object(c.useState)(""),i=Object(o.a)(r,2),s=i[0],l=i[1],u=Object(c.useState)(""),d=Object(o.a)(u,2),j=d[0],b=d[1],p=Object(c.useState)(!1),m=Object(o.a)(p,2),O=m[0],f=m[1];function R(){return(R=Object(g.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,b(""),l(""),f(!0),e.next=7,n(t.current.value);case 7:b("Check your email"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),l("Failed to reset password");case 13:f(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}return Object(a.jsx)(v.a,{container:!0,className:e.container,justify:"center",alignItems:"center",children:Object(a.jsxs)(v.a,{item:!0,xs:12,sm:6,children:[Object(a.jsx)(y.a,{className:e.card,children:Object(a.jsxs)(v.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(a.jsx)(w.a,{align:"center",variant:"h3",component:"h2",children:"Reset Password"}),s&&Object(a.jsx)(P.a,{severity:"error",children:s}),j&&Object(a.jsx)(P.a,{severity:"success",children:j}),Object(a.jsxs)("form",{onSubmit:function(e){return R.apply(this,arguments)},align:"center",className:e.root,children:[Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"email-input",label:"Email",inputRef:t,textalign:"center"})}),Object(a.jsx)(S.a,{disabled:O,variant:"contained",color:"primary",type:"submit",children:"Reset Password"}),Object(a.jsx)(w.a,{children:Object(a.jsx)(F.b,{to:"/login",children:"Login"})})]})]})}),Object(a.jsxs)(w.a,{align:"center",variant:"subtitle1",component:"h2",children:["Need an account? ",Object(a.jsx)(F.b,{to:"/signup",children:"Sign up"})]})]})})}var ee=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},width:"80%"},container:{height:"100vh"},card:{width:"100%",marginBottom:10,paddingBottom:5},inputField:{width:"100%",maxWidth:350}}}));function te(){var e=ee(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),i=Object(c.useRef)(),s=h(),l=s.currentUser,u=s.updatePassword,d=s.updateEmail,j=s.updateDisplayName,b=Object(c.useState)(""),p=Object(o.a)(b,2),m=p[0],O=p[1],f=Object(c.useState)(!1),x=Object(o.a)(f,2),g=x[0],R=x[1],C=Object(k.g)();return Object(a.jsx)(v.a,{container:!0,className:e.container,justify:"center",alignItems:"center",children:Object(a.jsxs)(v.a,{item:!0,xs:12,sm:6,children:[Object(a.jsx)(y.a,{className:e.card,children:Object(a.jsxs)(v.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(a.jsx)(w.a,{align:"center",variant:"h3",component:"h2",children:"Update Profile"}),m&&Object(a.jsx)(P.a,{severity:"error",children:m}),Object(a.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),n.current.value!==r.current.value)return O("Passwords do not match");var a=[];R(!0),O(""),t.current.value!==l.email&&a.push(d(t.current.value)),i.current.value!==l.displayName&&a.push(j(i.current.value)),n.current.value&&a.push(u(n.current.value)),Promise.all(a).then((function(){C.push("/")})).catch((function(e){O(e.message)})).finally((function(){R(!1)}))},align:"center",className:e.root,children:[Object(a.jsxs)(v.a,{item:!0,children:[Object(a.jsx)(N.a,{className:e.inputField,id:"display-name",label:"Display Name",inputRef:i,textalign:"center",defaultValue:l.displayName,placeholder:"Leave empty to keep the same",InputLabelProps:{shrink:!0}}),Object(a.jsx)(N.a,{className:e.inputField,required:!0,id:"email-input",label:"Email",inputRef:t,textalign:"center",defaultValue:l.email})]}),Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,id:"password-input",label:"Password",type:"password",autoComplete:"current-password",inputRef:n,placeholder:"Leave empty to keep the same",InputLabelProps:{shrink:!0}})}),Object(a.jsx)(v.a,{item:!0,children:Object(a.jsx)(N.a,{className:e.inputField,id:"password-confirm",label:"Password-confirm",type:"password",autoComplete:"current-password",inputRef:r,placeholder:"Leave empty to keep the same",InputLabelProps:{shrink:!0}})}),Object(a.jsx)(S.a,{disabled:g,variant:"contained",color:"primary",type:"submit",children:"Update"})]})]})}),Object(a.jsx)(w.a,{align:"center",variant:"subtitle1",component:"h2",children:Object(a.jsx)(F.b,{to:"/",children:"Cancel"})})]})})}var ne=n(71);function ae(e){var t=e.component,n=Object(ne.a)(e,["component"]),c=h().currentUser;return Object(a.jsx)(k.b,Object(q.a)(Object(q.a)({},n),{},{render:function(e){return c?Object(a.jsx)(t,Object(q.a)({},e)):Object(a.jsx)(k.a,{to:"/login"})}}))}var ce=Object(R.a)((function(e){return{container:{minHeight:"100vh",width:"100vw"}}}));var re=function(){var e=ce();return Object(a.jsx)(v.a,{container:!0,className:e.container,children:Object(a.jsx)(F.a,{children:Object(a.jsx)(O,{children:Object(a.jsxs)(k.d,{children:[Object(a.jsx)(ae,{exact:!0,path:"/",component:X}),Object(a.jsx)(ae,{exact:!0,path:"/UpdateProfile",component:te}),Object(a.jsx)(k.b,{path:"/signup",component:I}),Object(a.jsx)(k.b,{path:"/login",component:Q}),Object(a.jsx)(k.b,{path:"/forgot-password",component:$})]})})})})};n(95);s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(re,{})}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.1059824d.chunk.js.map